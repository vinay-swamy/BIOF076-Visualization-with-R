---
title: "R Notebook"
output: html_notebook
---
## Practice with themes 

We're going to work with one of the plots we made earlier 




```{r example_1}
library(ggplot2)
ggplot(mpg) + 
  geom_bar(aes(x=manufacturer, fill = class)) 
```


Assign descriptive axis labels and a plot title to the plot
```{r ex_1}

ggplot(mpg) + 
  geom_bar(aes(x=manufacturer, fill = class)) + 
  xlab('Car Manfucaturer') + 
  ylab('Number of Cars') +
  ggtitle('Cars by Manufacturer') 
```

fix the labels similar to how it was done in the example

```{r ex_2}

ggplot(mpg) + 
  geom_bar(aes(x=manufacturer, fill = class)) + 
  xlab('Car Manfucaturer') + 
  ylab('Number of Cars') +
  ggtitle('Cars by Manufacturer')  + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


change the y axis title so it is parallel to the x axis title 

```{r ex_3}
ggplot(mpg) + 
  geom_bar(aes(x=manufacturer, fill = class)) + 
  xlab('Car Manfucaturer') + 
  ylab('Number of Cars') +
  ggtitle('Cars by Manufacturer')  + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1) ,
        axis.title.y = element_text(angle = 0))
```

change the font of the title to Palantino, the color to red

```{r ex_4}

```


now use guide to re-position the legend to the top of the plot 
```{r ex_5}


```

## practice with colors

- We'll be working with the `storms` data set in dplyr library(we havent covered this yet, but we will) for this part 

```{r example_2}
library(dplyr)
data("storms")
storms
```

make a violin plot for `pressure`, using `status` as the x variable. Give axes appropriate titles. 

```{r ex_6}
ggplot(storms) + 
    geom_violin(aes(x=status, y=pressure, fill = status)) + 
    xlab('storm type') + 
    ylab('air pressure')
```

explore the palettes in the `pals` package. I've written a function to let you plot color palletes 
```{r example_3}
install.packages('pals')
install.packages('patchwork')
```

```{r example_4}
library(pals)
library(patchwork)
library(ggplot2)
library(tibble)
source('../src/plot_pal.R')
plot_pal(pals::alphabet(26))

```

pick a palette and use the appriate `scale_..._discrete` function to color your plot based on the `status` column


```{r ex_7}

pal <- pals::brewer.set3(4)
names(pal) <- NULL
ggplot(storms) + 
    geom_violin(aes(x=status, y=pressure, fill = status)) + 
    scale_fill_discrete(type = pal)+
    xlab('storm type') + 
    ylab('air pressure')
```

now pick colors from different palettes, and use them as part of a `scale_...manual`. 

```{r ex_8}
transposed_ge <-  gene_expression %>% 
  select(-transcript_id) %>%  t() %>% as.data.frame
colnames(transposed_ge) <- gene_expression$transcript_id
write_csv(transposed_ge, 'gene_expression_transposed.csv')

## Method 1
pal <- pals::
names(pal) <- NULL
unique(storms$status)
names(pal) <- c("tropical depression", "tropical storm","hurricane")

##Method 2
pal2 <- c('tropical depression'='red', 'tropical storm'='blue','hurricane'='green')
          
ggplot(storms) + 
    geom_violin(aes(x=status, y=pressure, fill = status)) + 
    scale_fill_manual(values = pal2)+
    xlab('storm type') + 
    ylab('air pressure')

```


make a scatter plot of `wind` vs `pressure`, using the `category` to color the points using a contionus scale. Make sure you change  `category` to a numeric type with `as.numeric` first

```{r ex_9}

```

## customizing multiple aesthetics 

- the `gapminder` dataset is a popular example dataset about the life expectancy, GDP and population for differnt countries across the world 
![](../src/gapminder_bubbleplot.png)

- this is a bubble plot. We're going to remake this plot with ggplot.
- gdpPercap as the x axis 
- lifeExp as the y axis
- pop as the point size( you will have to pass a mapping to size in `aes`)
- continent as the color
- alpha changed globally
- check out the function `scale_size` to see how to adjust point sizes
- use ggsave to save the plot to the disk, and adjust the output dimensions accordingly to match the example image


```{r ex_10}
library(readr)
library(ggrepel)
library(ggplot2)

data <- read_tsv('../src/gapminder_2007.tsv.gz')

plot <-  ggplot(data) + 
  geom_point(aes(x=gdpPercap, 
                 y = lifeExp, 
                 color = continent,
                 size = pop), alpha = .5) + 
  scale_size(range = c(0, 15)) + 
  guides(size = guide_legend(title = 'Population (M)'),
         color = guide_legend(title = 'Continent'))


ggsave('/Users/vinayswamy/Desktop/bubble.png', 
       plot = plot)
```


```{r}
knitr::include_graphics('bubble.png')
```



```{r}
p <- ggplot(mpg, aes(displ, hwy, size = hwy)) +
   geom_point()
p
p + scale_size("Highway mpg")
p + scale_size(range = c(0, 10))
```

