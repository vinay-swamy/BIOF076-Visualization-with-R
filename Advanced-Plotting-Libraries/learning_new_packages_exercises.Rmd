---
title: "R Notebook"
output: html_notebook
---

## install complexHeatmap
```{r}
install.packages(c('BiocManager','viridisLite' ))
BiocManager::install('ComplexHeatmap')

library(ComplexHeatmap) 
library(tidyverse)
```

- here is some example data we will be using

```{r}
gene_expression_matrix <- readRDS('../src/gene_expression_ss.RDS')

```

## A single heatmap 

- plot a heat map of the data 


```{r}
set.seed(123)
nr1 = 4; nr2 = 8; nr3 = 6; nr = nr1 + nr2 + nr3
nc1 = 6; nc2 = 8; nc3 = 10; nc = nc1 + nc2 + nc3
mat = cbind(rbind(matrix(rnorm(nr1*nc1, mean = 1,   sd = 0.5), nr = nr1),
          matrix(rnorm(nr2*nc1, mean = 0,   sd = 0.5), nr = nr2),
          matrix(rnorm(nr3*nc1, mean = 0,   sd = 0.5), nr = nr3)),
    rbind(matrix(rnorm(nr1*nc2, mean = 0,   sd = 0.5), nr = nr1),
          matrix(rnorm(nr2*nc2, mean = 1,   sd = 0.5), nr = nr2),
          matrix(rnorm(nr3*nc2, mean = 0,   sd = 0.5), nr = nr3)),
    rbind(matrix(rnorm(nr1*nc3, mean = 0.5, sd = 0.5), nr = nr1),
          matrix(rnorm(nr2*nc3, mean = 0.5, sd = 0.5), nr = nr2),
          matrix(rnorm(nr3*nc3, mean = 1,   sd = 0.5), nr = nr3))
   )
mat = mat[sample(nr, nr), sample(nc, nc)] # random shuffle rows and columns
rownames(mat) = paste0("row", seq_len(nr))
colnames(mat) = paste0("column", seq_len(nc))
Heatmap(mat)
```



```{r ex_1}
Heatmap(gene_expression_matrix)
```

- set the colors of the heat map using `colorRamp2`

```{r}
library(circlize)
col_fun = colorRamp2(c(-2, 0, 2), c("green", "white", "red"))
?colorRamp2
Heatmap(mat, name = "mat", col = col_fun)
```


```{r ex_2}
library(circlize)
col_fun = colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
Heatmap(gene_expression_matrix, col = col_fun)

```

- set the color to the viridis palette. you can generate a vector of viridis colors by using `viridisLite::viridis`

```{r ex_3}
viridisLite::viridis(5)
col_fun = colorRamp2(c(0, 2, 4, 6, 8), viridisLite::viridis())
Heatmap(gene_expression_matrix, col = col_fun)

df <- select(mtcars, mpg, cyl)
df2 <- filter(df, mpg == 21)
df3 <- mutate(df2, filename = 'asd')

df <- select(mtcars, mpg, cyl) %>% 
    filter(df, mpg == 21) %>% 
    mutate(df2, filename = 'asd')

```

- change the heatmap such that there is a white gap between each tile.

```{r ex_4}

```

- create row and column titles accordingly 

```{r ex_5}

```


- only cluster the columns

```{r ex_6}


```

## 2.7 Heatmap split

- split the heatmap into 3 subpieces, by column

```{r ex_7}




```


## Heatmap annotations 
- this file contains metadata about the samples in gene expression data. sample_accession corresponds to the name of each sample in the gene expression matrix.

```{r ex_8}
sample_metadata <- read_tsv('../src/gene_expression_sample_tsv.gz')

```

- create a simple column annotation that corresponds to the `Tissue` column in the sample metadata

```{r ex_9}


```



