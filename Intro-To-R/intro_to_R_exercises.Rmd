---
title: "Intro to R exercises"
output: html_notebook
---

This is an R notebook. It's a useful way to run code interactively. The blocks marked by the backticks are called chunks. press the play button to the top right of the chunk to run code. The title of the chunk is the test in the bracket. I will try to refer to chunks by their title

Note that chunks are entirely generated based the specific backtick characters. Deleting these characters will interfere with running the chunk, and you may see the play button disappear. If you have trouble running a chunk try deleting the chunk, or the chunks above and below, and write code in new chhunks. The short cut for indenting a chunk is `ctrl-alt-i` on windows and `cmd-option-i` on mac. 

```{r}

```

```{r}


```


```{r test_chunk }
"Welcome to R"
```

These first few chunks are working with variables. Run the chunk below. You should see a variable in the environment panel called "examlpe", storing the character "test"

```{r example_1}
example <- "test"
```

Now run this chunk

```{r example_2}
example <- test
```

this is an example of an error message, and you're gonna see a lot of them this week. Learning how to diagnose a problem from an error message is a key programming skill. In this case, the interpreter thinks that `test` is another variable(because there are no quotes), and so is looking for a variable named test, but cant find one. 

Sometimes, Rstudio is able to detect syntax errors, in this case a missing comma. Older versions of Rstudio are worse at picking up on these errors 

```{r}
my_vec <- v(1 2)
```


Try these exercises ( dont type in the same line as the "```" ticks )

Assign the number `5` to a variable named `x`

```{r ex_1}
vec_1 <- c(1, 2)
vec_2 <- c(3,4)

c(vec_1, vec_2)

```

Assign the word 'hello' to a variable named `greeting`

```{r}

greeting = 'hello'

```

Make a vector containing the numbers 3, 4, 5, and 6 

```{r ex_2}
my_vec <- c(3, 4, 5, 6)

```

Note at that the Environment section, vectors also display their length and associated data type.

Make 2 vectors, the first with numbers 2,5,7,2 and the second with 3,4,523, and then join them together 
```{r ex_3}
first_vec <- c(2, 5, 7, 2)
second_vec <- c(3, 4 ,523)
joined_vec <-  c(first_vec, second_vec)
```


select the first element from the following vector

```{r ex_4}
char_vec <- c('a','b','c','d', 'e')
char_vec[1]


```

select the last element from `char_vec`

```{r ex_5}
char_vec[5]
```

select the the 1st, 3rd, and 5th elements from `char_vec`

```{r ex_6}
locations <- c(1, 3, 5)

char_vec[locations]
```

select all values between the 2nd and 5th elements from `char_vec`

```{r ex_7}
char_vec

char_vec[2]
char_vec[locations]
char_vec[3:5]
```


Now, make a vector with the letter 'H', and the number 213

```{r ex_8}
var <- c('H', '213')
```

Pay close attention to this variable in the Environment section

## Function exercises

- all functions in R have documentation on how to use them to access this; use the `?` operator like so. A help window should be open on the right hand side of the screen. If you scroll to the bottom of the help section, there will always be an example of how to use it 

```{r example_3}
?paste
```


run this chunk to first clear the environment
```{r}
rm(list = ls())
```

calculate the mean for this vector (try using the `mean` function)

```{r ex_9}
vec <- c(23444, -12342, 23454, 64324, -45315)
mean_vec <- mean(vec)
```

The vector below is randomly generated numeric vector of length between 1 and 100. Use `length` to find the length of `random_vector`. run it a couple times to see it change

```{r ex_10}
random_length_vector=rnorm(n=sample(1:1000, 1))

```

use `paste` to concatenate these two characters 

```{r ex_11}
char1 <- 'hello'
char2 <- 'world'
paste(char1, char2)

```

Now, change the separator between the two characters from a space to `-`. try running `?paste` for help

```{r ex_12}
paste(char1, char2, sep ='-')
```

calculate the mean for each vector, and then add together using the `+` operator

```{r ex_13}
v1 <- c(1,4,23)
v2 <- c(4,56,23,12)
v3 <- c(123,4, -40, -50, 34)

sum(c(mean(v1) , mean(v2) , mean(v3)))
mean(v1) + mean(v2) + mean(v3)
```

now calculate the mean for each above vector, but use the `sum` function.(hint: you need to make a vector)

```{r ex_14}


```


## Writing your own functions 

write your own function that takes a number as an input, and adds the number `5` to it

```{r ex_15}
add_5 <- function(number){
    res <- number + 5
    print(res)

    return(res)
}


```

write your own function that takes a vector as input and returns the last element (hint: use the `length` function). Test it on  `v1`, `v2`, and `v3` defined earlier

```{r ex_16}
length(v1)
get_last <- function(x){
  last_position = length(x)
  result <- x[last_position]
  return(result)
}

get_last(v3)

```

## working with lists 

You can explore the values in list in the environment viewer. click the arrow on the left hand side to view values in the list

```{r example_4}
list_to_view <- list(a='v', 
                     b=c(1,4,6,7,5), 
                     x=c('c', 'd'))

```

Declare a list with two using two vectors below. when declaring the list, name the `a` vector condition_a, and the `b` vector condition_b

```{r ex_17}
a <- c(0,1,2,3,4)
b <- c(0,2,4,6,8)


experiment_list <- list( condition_a = a, condition_b = b )
### OR
experiment_list <- list(a, b)
names(experiment_list) <-c('condition_a', 'condition_b')
```

using the `names` function, change the names of condition_a to "wild_type", and condition_b to "knock_out"

```{r ex_18}

names(experiment_list) <-c('wild_type', 'knock_out')
```

change the last value in wild_type from 4 to -1 (hint: you will need to first access wild_type within the list, and then acces the first element within wild_type)

```{r ex_19}
experiment_list[['wild_type']][5] <- 1
experiment_list$wild_type[5] <- 1
```


## Data.frame exercises

- this is a small data frame we'll be working with. The numbers are all made up. Run this chunk to generate the data for below

```{r}
faang_data <- data.frame(name = c('Facebook', 'apple', 'amazon', 'netflix', 'google'), 
                         revenue = c(3000000000, 4000000000, 5000000000, 3000000000, 3000000000),
                         n_employees=c(2000, 8000, 10000, 5000, 12000),
                         ceo = c('mark', 'tim', 'jeff', 'reed hastings', 'sundar pichai' ),
                         service = c('ads', 'tech', 'shipping', 'streaming', 'ads'),
                         stringsAsFactors = F
                         )
faang_data
```



Rstudio has a built in data frame viewer to allow you to inspect data. click on the `faang_data` variable in the environment panel 

click on the column names to order by that column. Use the filter button to subset the data. This does not change the actual data, but is used only for exploration.

Rstudio also has autocomplete capabilities, which you can access by pressing `tab`. try in this chunk - place the cursor next to `$` and press tab. you should see the column names for the `faang_data` dataframe 

```{r}
faang_data$n_employees
```

The autocomplete generally works pretty well and will save you a lot of time.

## excercises

- calculate the revenue per employee and store it in new columns

```{r ex_21}
faang_data$rev_per_employee <-  faang_data$revenue / faang_data$n_employees
```

- the `which.max` function returns the index for the maximum value in a vector. Use this to identify the company with the highest revenue and select its ceo

```{r ex_22}
highest_rev <- which.max(faang_data$revenue)

faang_data[highest_rev,'ceo']
```

- use the `paste` function to add the last names to the ceos missing last names. ( Mark zuckerberg, tim cook, and jeff bezos in case you do not know)

```{r, ex_23}
last_names <- c( 'zuckerberg', 'cook',  'bezos')
faang_data_with_lastnames <- faang_data
faang_data_with_lastnames$ceo[1:3] <- paste(faang_data$ceo[1:3], last_names )
```


- write a function that takes a column name as input and returns the mean, and use it to calculate the mean of the `revenue` and `n_employees` columns in `faang_data`

```{r}

## not the best way 
calculate_mean_faang <- function(col_name){
  col_mean <-  mean(faang_data[,col_name])
  return(col_mean)
}

## better way 
calculate_mean_faang <- function(col_name, target_df){
  col_mean <-  mean(target_df[,col_name])
  return(col_mean)
}

calculate_mean_faang('revenue', faang_data)

```

## Factors

To illustrate the memory saving properties of factors, run this chunk and look at how much memory the variables use

```{r example_6}
long_char_vec <- sample(letters, 1000000, replace = T)
long_factor_vec <- as.factor(long_char_vec)
```

The vector below contains primate species names. Run the chunk to see data in the vector

```{r example_7}
species_vec <- sample(
  c('Homo Sapiens','Macaca Fascicularis', 'Pan Troglodytes', 'Gorilla Gorilla'  ), 
  50,
  replace = T)
species_vec

```

the `sort` function arranges vectors in order. For `numeric` data it is sorted from smallest to largest. For `character`, it is sorted in Alphabetic order. try using `sort` on species vec

```{r ex_24}
sort(species_vec)
```

create a `factor` from `species_vec`, and use the `unique` function to set the levels

```{r, ex_25}
#unique(sort(species_vec))
speices_factor = factor(x = species_vec, 
       levels = c('Homo Sapiens','Macaca Fascicularis', 'Pan Troglodytes', 'Gorilla Gorilla')
    )
```

create a factor from `species_vec` and set the levels in a following order: 'Macaca Fascicularis','Homo Sapiens', 'Gorilla Gorilla', 'Pan Troglodytes'. You may need to store this ordering in a new vector

```{r, ex_26}
sort(speices_factor)
```


- convert all the `factor` variables in `faang_data` to `character` using `as.character`. if you are unsure which variables are factors, run `str(faang_data)`  or use the variable explorer

```{r ex_27}

faang_data <- data.frame(name = c('Facebook', 'apple', 'amazon', 'netflix', 'google'), 
                         revenue = c(3000000000, 4000000000, 5000000000, 3000000000, 3000000000),
                         n_employees=c(2000, 8000, 10000, 5000, 12000),
                         ceo = c('mark', 'tim', 'jeff', 'reed hastings', 'sundar pichai' ),
                         service = c('ads', 'tech', 'shipping', 'streaming', 'ads'),
                         stringsAsFactors = T
                         )

faang_data$name <- as.character(faang_data$name)
faang_data$ceo <- as.character(faang_data$ceo)
faang_data$service <- as.character(faang_data$service)
```


